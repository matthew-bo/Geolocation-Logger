exports.id=651,exports.ids=[651],exports.modules={29871:(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.d(t,{Z:()=>q});var a=r(20997),i=r(16689),s=r(11163),o=r(41664),c=r.n(o),d=r(94851),l=r(14117),h=r(9285),u=r.n(h),p=r(15419),x=r.n(p),m=r(37963),f=r.n(m),g=r(66319),y=r.n(g),j=r(72265),w=r.n(j),k=r(63389),b=r.n(k),v=r(30713),I=r.n(v),D=r(86024),P=r.n(D),C=r(34904),A=r.n(C),S=r(86096),Z=r.n(S),L=r(98369),_=r.n(L),F=r(75244),T=r(92023),O=r(74347),E=r(19933),H=r(44732),R=r(39029),M=r(6236),Q=r(92098),W=e([Q]);function q({children:e}){let{isAuthenticated:t,logout:r}=(0,Q.a)(),n=(0,s.useRouter)(),[o,h]=(0,i.useState)(!1),p=(0,d.Z)(),m=(0,l.Z)(p.breakpoints.down("sm")),g=()=>{h(!o)},j=[{text:"Log Drink",icon:a.jsx(F.Z,{}),href:"/log-drink"},{text:"Map View",icon:a.jsx(T.Z,{}),href:"/map"},{text:"Friends",icon:a.jsx(O.Z,{}),href:"/friends"},{text:"Profile",icon:a.jsx(E.Z,{}),href:"/profile"},{text:"Leaderboard",icon:a.jsx(H.Z,{}),href:"/leaderboards"}],k=a.jsx(u(),{sx:{width:250},role:"presentation",onClick:g,children:(0,a.jsxs)(x(),{children:[j.map(e=>(0,a.jsxs)(f(),{button:!0,component:c(),href:e.href,selected:n.pathname===e.href,children:[a.jsx(y(),{children:e.icon}),a.jsx(w(),{primary:e.text})]},e.text)),t&&(0,a.jsxs)(f(),{button:!0,onClick:r,children:[a.jsx(y(),{children:a.jsx(R.Z,{})}),a.jsx(w(),{primary:"Logout"})]})]})});return(0,a.jsxs)(u(),{sx:{display:"flex"},children:[a.jsx(b(),{position:"fixed",children:(0,a.jsxs)(I(),{children:[t&&a.jsx(P(),{color:"inherit","aria-label":"open drawer",edge:"start",onClick:g,sx:{mr:2,display:{sm:"none"}},children:a.jsx(M.Z,{})}),a.jsx(A(),{variant:"h6",component:c(),href:"/",sx:{flexGrow:1,color:"inherit",textDecoration:"none"},children:"DrinkTracker"}),t?!m&&(0,a.jsxs)(u(),{sx:{display:"flex",gap:2},children:[j.map(e=>a.jsx(Z(),{color:"inherit",component:c(),href:e.href,startIcon:e.icon,children:e.text},e.text)),a.jsx(Z(),{color:"inherit",onClick:r,startIcon:a.jsx(R.Z,{}),children:"Logout"})]}):(0,a.jsxs)(u(),{children:[a.jsx(Z(),{color:"inherit",component:c(),href:"/login",children:"Login"}),a.jsx(Z(),{color:"inherit",component:c(),href:"/register",children:"Sign Up"})]})]})}),t&&a.jsx(_(),{variant:"temporary",anchor:"left",open:o,onClose:g,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{width:250}},children:k}),a.jsx(u(),{component:"main",sx:{flexGrow:1,p:3,width:"100%",minHeight:"100vh",pt:{xs:8,sm:9}},children:e})]})}Q=(W.then?(await W)():W)[0],n()}catch(e){n(e)}})},32994:(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.d(t,{I:()=>l,db:()=>h});var a=r(23745),i=r(60401),s=r(1492),o=r(9500),c=e([a,i,s,o]);[a,i,s,o]=c.then?(await c)():c;let d=(0,a.initializeApp)({apiKey:"AIzaSyC3B9owv3AbK9pupIxlrvQYNdsWmQrIxIw",authDomain:"geolocation-c8fa1.firebaseapp.com",projectId:"geolocation-c8fa1",storageBucket:"geolocation-c8fa1.appspot.com",messagingSenderId:"437052534338",appId:"1:437052534338:web:c7d49a9fd508d6530807db",measurementId:"G-WFHD3TRX48"}),l=(0,i.getAuth)(d),h=(0,s.getFirestore)(d);n()}catch(e){n(e)}})},92098:(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.d(t,{H:()=>h,a:()=>u});var a=r(20997),i=r(16689),s=r(11163),o=r(60401),c=r(1492),d=r(32994),l=e([o,c,d]);[o,c,d]=l.then?(await l)():l;let p=(0,i.createContext)({}),x={logDrink:!0,addFriend:!0,editProfile:!0,removeFriend:!0};function h({children:e}){let[t,r]=(0,i.useState)(null),[n,l]=(0,i.useState)(!0),h=(0,s.useRouter)();(0,i.useEffect)(()=>(0,o.onAuthStateChanged)(d.I,e=>{r(e),l(!1)}),[]);let u=async({email:e,password:t,firstName:r,lastName:n,username:a})=>{try{let i=(0,c.query)((0,c.collection)(d.db,"users"),(0,c.where)("username","==",a));if(!(await (0,c.getDocs)(i)).empty)return{success:!1,message:"Username already taken. Please choose another one."};let{user:s}=await (0,o.createUserWithEmailAndPassword)(d.I,e,t);await (0,o.updateProfile)(s,{displayName:a}),await s.getIdToken(!0),await new Promise(e=>setTimeout(e,500));try{await (0,c.setDoc)((0,c.doc)(d.db,"users",s.uid),{email:e,firstName:r,lastName:n,username:a,displayName:a,previousDrinks:[],createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()})}catch(e){console.error("Firestore document creation error:",e)}return h.push("/"),{success:!0}}catch(e){return console.error("Registration error:",e),{success:!1,message:e.message}}},m=async(e,t)=>{try{return await (0,o.signInWithEmailAndPassword)(d.I,e,t),{success:!0}}catch(e){return{success:!1,message:e.message}}},f=async()=>{try{await (0,o.signOut)(d.I),h.push("/")}catch(e){console.error("Logout error:",e)}},g=e=>x[e]||!1;return a.jsx(p.Provider,{value:{user:t,loading:n,login:m,register:u,logout:f,requiresAuth:g,handleProtectedAction:(e,r)=>!t&&g(e)?(h.pathname&&sessionStorage.setItem("redirectAfterLogin",h.pathname),h.push("/login"),!1):(r&&r(),!0),isAuthenticated:!!t},children:!n&&e})}function u(){return(0,i.useContext)(p)}n()}catch(e){n(e)}})},55585:(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.d(t,{J:()=>l});var a=r(20997),i=r(16689),s=r(1492),o=r(32994),c=r(92098),d=e([s,o,c]);[s,o,c]=d.then?(await d)():d;let h=(0,i.createContext)();function l({children:e}){let{user:t}=(0,c.a)(),[r,n]=(0,i.useState)({friends:0,leaderboards:0,map:0,logDrink:0});return(0,i.useEffect)(()=>{if(!t){n({friends:0,leaderboards:0,map:0,logDrink:0});return}let e=(0,s.query)((0,s.collection)(o.db,"notifications"),(0,s.where)("userId","==",t.uid),(0,s.where)("read","==",!1)),r=(0,s.onSnapshot)(e,e=>{let t={friends:0,leaderboards:0,map:0,logDrink:0};e.forEach(e=>{switch(e.data().type){case"friend_request":case"friend_accepted":t.friends++;break;case"group_invite":case"challenge_created":case"group_update":t.leaderboards++;break;case"nearby_friend":case"location_alert":t.map++;break;case"drink_reminder":case"drink_milestone":t.logDrink++}}),n(t)});return()=>r()},[t]),a.jsx(h.Provider,{value:{notifications:r},children:e})}n()}catch(e){n(e)}})},4651:(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>k});var a=r(20997);r(16689);var i=r(18442),s=r(94960),o=r.n(s),c=r(3590),d=r(61175),l=r(92098),h=r(55585),u=r(73280),p=r(44046),x=r(29871),m=r(66197),f=r(11163);r(88819),r(30108),r(35078);var g=e([c,l,h,x,m]);[c,l,h,x,m]=g.then?(await g)():g;let y=new d.QueryClient,j=(0,i.createTheme)({palette:{primary:{main:"#1976d2"},secondary:{main:"#f50057"}}}),w={initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,y:-20,transition:{duration:.3,ease:[.4,0,.2,1]}}},k=function({Component:e,pageProps:t}){let r=(0,f.useRouter)();return a.jsx(d.QueryClientProvider,{client:y,children:a.jsx(l.H,{children:a.jsx(h.J,{children:a.jsx(u.LocalizationProvider,{dateAdapter:p.AdapterDateFns,children:(0,a.jsxs)(i.ThemeProvider,{theme:j,children:[a.jsx(o(),{}),(0,a.jsxs)(x.Z,{children:[a.jsx(m.AnimatePresence,{mode:"wait",children:a.jsx(m.motion.div,{initial:"initial",animate:"animate",exit:"exit",variants:w,style:{width:"100%"},children:a.jsx(e,{...t})},r.route)}),a.jsx(c.ToastContainer,{position:"bottom-right",autoClose:4e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark"})]})]})})})})})};n()}catch(e){n(e)}})},30108:()=>{},35078:()=>{}};