"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[656],{99656:function(e,t,a){a.d(t,{Z:function(){return V}});var l=a(85893),r=a(67294),n=a(5616),s=a(93946),i=a(15861),o=a(86886),c=a(34386),d=a(66242),x=a(44267),h=a(591),u=a(47120),m=a(94054),p=a(33841),v=a(85945),Z=a(18972),b=a(66672),y=a(61903),g=a(64666),j=a(37645),f=a(6514),w=a(31425),k=a(69417),M=a(14354),C=a(46901),D=a(26495),P=a(23148),S=a(75108),I=a(63252),z=a(49185),B=a(92759),W=a(64232),q=a(93429),R=a(96406),F=a(584),T=a(43703),_=a(67090),E=a(4135),U=a(9005),A=a(20466),L=a(32912),O=a(82644),H=a(49160),N=a(51085);P.kL.register(P.uw,P.f$,P.ZL,P.Dx,P.u,P.De);let Y=[{value:"week",label:"Past Week"},{value:"month",label:"Past Month"},{value:"3months",label:"Past 3 Months"},{value:"year",label:"Past Year"}],G=[{value:"total",label:"Total Drinks"},{value:"unique",label:"Unique Beers"},{value:"rating",label:"Average Rating"}],$=[{value:"day",label:"By Day"},{value:"week",label:"By Week"},{value:"month",label:"By Month"}],Q=e=>{let{data:t,metric:a,currentDate:d,setCurrentDate:x}=e,h=(0,r.useMemo)(()=>{let e=(0,F.Z)((0,T.Z)(d)),t=(0,_.Z)((0,E.Z)(d)),a=(0,U.Z)({start:e,end:t}),l=[],r=[];if(a.forEach(e=>{if(0===r.length&&0!==(0,A.Z)(e))for(let t=0;t<(0,A.Z)(e);t++)r.push(null);r.push(e),6===(0,A.Z)(e)&&(l.push(r),r=[])}),r.length>0){for(;r.length<7;)r.push(null);l.push(r)}return l},[d]),u=e=>e?t[(0,L.Z)(e,"yyyy-MM-dd")]||0:null,m=Math.max(...Object.values(t)),p={xs:"75px",sm:"90px"};return(0,l.jsxs)(n.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",p:{xs:.5,sm:1}},children:[(0,l.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,l.jsx)(s.Z,{onClick:()=>{let e=new Date(d);e.setMonth(e.getMonth()-1),x(e)},size:"small",sx:{color:"var(--text-primary)"},children:(0,l.jsx)(i.Z,{variant:"body1",children:"←"})}),(0,l.jsx)(i.Z,{variant:"body1",sx:{color:"var(--text-primary)"},children:(0,L.Z)(d,"MMMM yyyy")}),(0,l.jsx)(s.Z,{onClick:()=>{let e=new Date(d);e.setMonth(e.getMonth()+1),x(e)},size:"small",sx:{color:"var(--text-primary)"},children:(0,l.jsx)(i.Z,{variant:"body1",children:"→"})})]}),(0,l.jsxs)(n.Z,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[(0,l.jsx)(o.ZP,{container:!0,spacing:.25,children:["S","M","T","W","T","F","S"].map(e=>(0,l.jsx)(o.ZP,{item:!0,xs:12/7,children:(0,l.jsx)(i.Z,{align:"center",sx:{color:"var(--text-secondary)",fontSize:"0.7rem",fontWeight:"bold"},children:e})},e))}),(0,l.jsx)(n.Z,{sx:{flex:1,display:"flex",flexDirection:"column"},children:h.map((e,t)=>(0,l.jsx)(o.ZP,{container:!0,spacing:.25,children:e.map((e,t)=>(0,l.jsx)(o.ZP,{item:!0,xs:12/7,sx:{height:p},children:e&&(0,l.jsx)(c.Z,{title:"".concat((0,L.Z)(e,"MMM d, yyyy"),"\n").concat(u(e)," ").concat("total"===a?"drinks":"unique"===a?"unique beers":"avg rating"),children:(0,l.jsxs)(n.Z,{sx:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:.5,cursor:"pointer",bgcolor:(0,O.Z)(e)?"transparent":"rgba(251, 192, 45, ".concat(u(e)/(m||1)*.7,")"),border:(0,H.Z)(e,d)&&(0,N.Z)(e)?"2px solid var(--beer-amber)":"1px solid var(--border-color)",opacity:(0,H.Z)(e,d)?1:.3,"&:hover":{bgcolor:"var(--beer-amber)",opacity:.8}},children:[(0,l.jsx)(i.Z,{sx:{fontSize:{xs:"0.65rem",sm:"0.7rem"},color:"var(--text-primary)",fontWeight:(0,N.Z)(e)?"bold":"normal",lineHeight:1},children:(0,L.Z)(e,"d")}),u(e)>0&&(0,l.jsx)(i.Z,{sx:{fontSize:{xs:"0.55rem",sm:"0.6rem"},color:"var(--text-secondary)",lineHeight:1,mt:.25},children:u(e)})]})})},t))},t))})]})]})};function V(e){var t,a;let{drinks:i}=e,[P,T]=(0,r.useState)("month"),[_,E]=(0,r.useState)("total"),[U,A]=(0,r.useState)("day"),[O,H]=(0,r.useState)(null),[N,V]=(0,r.useState)("bar"),[J,K]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),[et,ea]=(0,r.useState)(""),[el,er]=(0,r.useState)(new Date),en=(0,r.useMemo)(()=>{let e=new Set;return i.forEach(t=>{var a,l,r;(null===(a=t.placeInfo)||void 0===a?void 0:a.city)&&e.add(t.placeInfo.city),(null===(l=t.placeInfo)||void 0===l?void 0:l.state)&&e.add(t.placeInfo.state),(null===(r=t.placeInfo)||void 0===r?void 0:r.country)&&e.add(t.placeInfo.country)}),Array.from(e)},[i]),es=(0,r.useMemo)(()=>{let e=new Date,t=new Date;switch(P){case"week":t.setDate(e.getDate()-7);break;case"month":t.setMonth(e.getMonth()-1);break;case"3months":t.setMonth(e.getMonth()-3);break;case"year":t.setFullYear(e.getFullYear()-1)}let a=i.filter(a=>{var l,r,n;let s=new Date(a.timestamp),i=!O||(null===(l=a.placeInfo)||void 0===l?void 0:l.city)===O||(null===(r=a.placeInfo)||void 0===r?void 0:r.state)===O||(null===(n=a.placeInfo)||void 0===n?void 0:n.country)===O;return s>=t&&s<=e&&i}),l={};a.forEach(e=>{let t;let a=new Date(e.timestamp);switch(U){case"day":t=(0,L.Z)(a,"yyyy-MM-dd");break;case"week":let r=(0,F.Z)(a);t=(0,L.Z)(r,"yyyy-MM-dd");break;case"month":t=(0,L.Z)(a,"yyyy-MM")}l[t]||(l[t]={drinks:[],uniqueBeers:new Set,ratings:[]}),l[t].drinks.push(e),l[t].uniqueBeers.add(e.brand),e.rating&&l[t].ratings.push(e.rating)});let r=Object.keys(l).sort(),n=r.map(e=>{let t=l[e];switch(_){case"total":return t.drinks.length;case"unique":return t.uniqueBeers.size;case"rating":return t.ratings.length>0?t.ratings.reduce((e,t)=>e+t)/t.ratings.length:0}}),s={};return Object.entries(l).forEach(e=>{let[t,a]=e;s[t]="total"===_?a.drinks.length:"unique"===_?a.uniqueBeers.size:a.ratings.length>0?a.ratings.reduce((e,t)=>e+t)/a.ratings.length:0}),{labels:r,data:n,calendarData:s}},[i,P,_,U,O]),ei={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"".concat((null===(t=G.find(e=>e.value===_))||void 0===t?void 0:t.label)||""," ").concat((null===(a=$.find(e=>e.value===U))||void 0===a?void 0:a.label)||""),color:"var(--text-primary)",font:{size:16,weight:"normal"}},tooltip:{callbacks:{label:e=>"rating"===_?"Rating: ".concat(e.raw.toFixed(1)):"".concat(e.raw," ").concat("total"===_?"drinks":"beers")}}},scales:{y:{beginAtZero:!0,ticks:{precision:"rating"===_?1:0,color:"var(--text-secondary)"},grid:{color:"var(--border-color)",drawBorder:!1}},x:{ticks:{color:"var(--text-secondary)"},grid:{display:!1}}}},eo={labels:es.labels.map(e=>"month"===U?(0,L.Z)(new Date(e),"MMM yyyy"):(0,L.Z)(new Date(e),"MMM d")),datasets:[{data:es.data,backgroundColor:"rgba(251, 192, 45, 0.6)",borderColor:"var(--copper)",borderWidth:1,borderRadius:4,hoverBackgroundColor:"var(--beer-amber)"}]},ec=async e=>{var t,a;let l="Check out my beer stats: ".concat(null===(t=G.find(e=>e.value===_))||void 0===t?void 0:t.label," ").concat(null===(a=$.find(e=>e.value===U))||void 0===a?void 0:a.label),r=window.location.href;switch(e){case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(r)),"_blank");break;case"twitter":window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(l),"&url=").concat(encodeURIComponent(r)),"_blank");break;case"whatsapp":window.open("https://wa.me/?text=".concat(encodeURIComponent(l+" "+r)),"_blank");break;case"copy":try{await navigator.clipboard.writeText(r),ea("Link copied to clipboard!"),ee(!0)}catch(e){ea("Failed to copy link"),ee(!0)}}K(!1)};return(0,l.jsx)(d.Z,{className:"premium-card",sx:{overflow:"visible"},children:(0,l.jsxs)(x.Z,{children:[(0,l.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",gap:2},children:[(0,l.jsxs)(h.Z,{value:N,exclusive:!0,onChange:(e,t)=>t&&V(t),size:"small",sx:{"& .MuiToggleButton-root":{color:"var(--text-secondary)","&.Mui-selected":{color:"var(--beer-amber)",bgcolor:"rgba(251, 192, 45, 0.1)"}}},children:[(0,l.jsx)(u.Z,{value:"bar",children:(0,l.jsx)(c.Z,{title:"Bar Chart",children:(0,l.jsx)(S.Z,{})})}),(0,l.jsx)(u.Z,{value:"calendar",children:(0,l.jsx)(c.Z,{title:"Calendar View",children:(0,l.jsx)(I.Z,{})})})]}),(0,l.jsx)(s.Z,{onClick:()=>K(!0),sx:{color:"var(--text-secondary)"},children:(0,l.jsx)(z.Z,{})})]}),(0,l.jsxs)(o.ZP,{container:!0,spacing:2,sx:{mb:2},children:["bar"===N&&(0,l.jsx)(o.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,l.jsxs)(m.Z,{fullWidth:!0,size:"small",children:[(0,l.jsx)(p.Z,{children:"Time Frame"}),(0,l.jsx)(v.Z,{value:P,label:"Time Frame",onChange:e=>T(e.target.value),children:Y.map(e=>(0,l.jsx)(Z.Z,{value:e.value,children:e.label},e.value))})]})}),(0,l.jsx)(o.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,l.jsxs)(m.Z,{fullWidth:!0,size:"small",children:[(0,l.jsx)(p.Z,{children:"Metric"}),(0,l.jsx)(v.Z,{value:_,label:"Metric",onChange:e=>E(e.target.value),children:G.map(e=>(0,l.jsx)(Z.Z,{value:e.value,children:e.label},e.value))})]})}),"bar"===N&&(0,l.jsx)(o.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,l.jsxs)(m.Z,{fullWidth:!0,size:"small",children:[(0,l.jsx)(p.Z,{children:"Group By"}),(0,l.jsx)(v.Z,{value:U,label:"Group By",onChange:e=>A(e.target.value),children:$.map(e=>(0,l.jsx)(Z.Z,{value:e.value,children:e.label},e.value))})]})}),(0,l.jsx)(o.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,l.jsx)(b.Z,{size:"small",value:O,onChange:(e,t)=>H(t),options:en,renderInput:e=>(0,l.jsx)(y.Z,{...e,label:"Filter by Location",fullWidth:!0})})})]}),(0,l.jsx)(n.Z,{sx:{height:{xs:450,sm:550}},children:"bar"===N?(0,l.jsx)(D.$Q,{options:ei,data:eo}):(0,l.jsx)(Q,{data:es.calendarData,metric:_,currentDate:el,setCurrentDate:er})}),(0,l.jsxs)(g.Z,{open:J,onClose:()=>K(!1),PaperProps:{sx:{bgcolor:"var(--background)",color:"var(--text-primary)",border:"1px solid var(--border-color)"}},children:[(0,l.jsx)(j.Z,{children:"Share Stats"}),(0,l.jsx)(f.Z,{children:(0,l.jsxs)(o.ZP,{container:!0,spacing:2,sx:{mt:1},children:[(0,l.jsx)(o.ZP,{item:!0,xs:3,children:(0,l.jsx)(s.Z,{onClick:()=>ec("facebook"),sx:{color:"#1877f2"},children:(0,l.jsx)(B.Z,{})})}),(0,l.jsx)(o.ZP,{item:!0,xs:3,children:(0,l.jsx)(s.Z,{onClick:()=>ec("twitter"),sx:{color:"#1da1f2"},children:(0,l.jsx)(W.Z,{})})}),(0,l.jsx)(o.ZP,{item:!0,xs:3,children:(0,l.jsx)(s.Z,{onClick:()=>ec("whatsapp"),sx:{color:"#25d366"},children:(0,l.jsx)(q.Z,{})})}),(0,l.jsx)(o.ZP,{item:!0,xs:3,children:(0,l.jsx)(s.Z,{onClick:()=>ec("copy"),sx:{color:"var(--text-primary)"},children:(0,l.jsx)(R.Z,{})})})]})}),(0,l.jsx)(w.Z,{children:(0,l.jsx)(k.Z,{onClick:()=>K(!1),sx:{color:"var(--text-secondary)"},children:"Close"})})]}),(0,l.jsx)(M.Z,{open:X,autoHideDuration:3e3,onClose:()=>ee(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,l.jsx)(C.Z,{onClose:()=>ee(!1),severity:"success",sx:{width:"100%"},children:et})})]})})}}}]);