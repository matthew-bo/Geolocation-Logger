(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128],{62026:function(e,r,t){"use strict";var s=t(88169),a=t(85893);r.Z=(0,s.Z)((0,a.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check")},69661:function(e,r,t){"use strict";t.d(r,{Z:function(){return w}});var s=t(63366),a=t(87462),o=t(67294),n=t(90512),i=t(94780),d=t(90948),l=t(28628),c=t(88169),u=t(85893),m=(0,c.Z)((0,u.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person"),h=t(1588),p=t(34867);function v(e){return(0,p.ZP)("MuiAvatar",e)}(0,h.Z)("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);var f=t(80560);let x=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],g=e=>{let{classes:r,variant:t,colorDefault:s}=e;return(0,i.Z)({root:["root",t,s&&"colorDefault"],img:["img"],fallback:["fallback"]},v,r)},b=(0,d.ZP)("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[r.root,r[t.variant],t.colorDefault&&r.colorDefault]}})(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:(0,a.Z)({color:(e.vars||e).palette.background.default},e.vars?{backgroundColor:e.vars.palette.Avatar.defaultBg}:(0,a.Z)({backgroundColor:e.palette.grey[400]},e.applyStyles("dark",{backgroundColor:e.palette.grey[600]})))}]})),y=(0,d.ZP)("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,r)=>r.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Z=(0,d.ZP)(m,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,r)=>r.fallback})({width:"75%",height:"75%"});var w=o.forwardRef(function(e,r){let t=(0,l.i)({props:e,name:"MuiAvatar"}),{alt:i,children:d,className:c,component:m="div",slots:h={},slotProps:p={},imgProps:v,sizes:w,src:j,srcSet:P,variant:C="circular"}=t,R=(0,s.Z)(t,x),q=null,S=function({crossOrigin:e,referrerPolicy:r,src:t,srcSet:s}){let[a,n]=o.useState(!1);return o.useEffect(()=>{if(!t&&!s)return;n(!1);let a=!0,o=new Image;return o.onload=()=>{a&&n("loaded")},o.onerror=()=>{a&&n("error")},o.crossOrigin=e,o.referrerPolicy=r,o.src=t,s&&(o.srcset=s),()=>{a=!1}},[e,r,t,s]),a}((0,a.Z)({},v,{src:j,srcSet:P})),k=j||P,E=k&&"error"!==S,F=(0,a.Z)({},t,{colorDefault:!E,component:m,variant:C}),N=g(F),[U,L]=(0,f.Z)("img",{className:N.img,elementType:y,externalForwardedProps:{slots:h,slotProps:{img:(0,a.Z)({},v,p.img)}},additionalProps:{alt:i,src:j,srcSet:P,sizes:w},ownerState:F});return q=E?(0,u.jsx)(U,(0,a.Z)({},L)):d||0===d?d:k&&i?i[0]:(0,u.jsx)(Z,{ownerState:F,className:N.fallback}),(0,u.jsx)(b,(0,a.Z)({as:m,ownerState:F,className:(0,n.Z)(N.root,c),ref:r},R,{children:q}))})},66242:function(e,r,t){"use strict";t.d(r,{Z:function(){return g}});var s=t(87462),a=t(63366),o=t(67294),n=t(90512),i=t(94780),d=t(90948),l=t(28628),c=t(90629),u=t(1588),m=t(34867);function h(e){return(0,m.ZP)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var p=t(85893);let v=["className","raised"],f=e=>{let{classes:r}=e;return(0,i.Z)({root:["root"]},h,r)},x=(0,d.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,r)=>r.root})(()=>({overflow:"hidden"}));var g=o.forwardRef(function(e,r){let t=(0,l.i)({props:e,name:"MuiCard"}),{className:o,raised:i=!1}=t,d=(0,a.Z)(t,v),c=(0,s.Z)({},t,{raised:i}),u=f(c);return(0,p.jsx)(x,(0,s.Z)({className:(0,n.Z)(u.root,o),elevation:i?8:void 0,ref:r,ownerState:c},d))})},80560:function(e,r,t){"use strict";t.d(r,{Z:function(){return m}});var s=t(87462),a=t(63366),o=t(33703),n=t(86542),i=t(65610),d=t(55120);let l=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],c=["component","slots","slotProps"],u=["component"];function m(e,r){let{className:t,elementType:m,ownerState:h,externalForwardedProps:p,getSlotOwnerState:v,internalForwardedProps:f}=r,x=(0,a.Z)(r,l),{component:g,slots:b={[e]:void 0},slotProps:y={[e]:void 0}}=p,Z=(0,a.Z)(p,c),w=b[e]||m,j=(0,i.Z)(y[e],h),P=(0,d.Z)((0,s.Z)({className:t},x,{externalForwardedProps:"root"===e?Z:void 0,externalSlotProps:j})),{props:{component:C},internalRef:R}=P,q=(0,a.Z)(P.props,u),S=(0,o.Z)(R,null==j?void 0:j.ref,r.ref),k=v?v(q):{},E=(0,s.Z)({},h,k),F="root"===e?C||g:C,N=(0,n.Z)(w,(0,s.Z)({},"root"===e&&!g&&!b[e]&&f,"root"!==e&&!b[e]&&f,q,F&&{as:F},{ref:S}),E);return Object.keys(k).forEach(e=>{delete N[e]}),[w,N]}},11057:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/friends",function(){return t(99986)}])},99986:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return E}});var s=t(85893),a=t(67294),o=t(5616),n=t(93946),i=t(15861),d=t(66242),l=t(79136),c=t(40044),u=t(78462),m=t(9875),h=t(69661),p=t(59334),v=t(93395),f=t(61903),x=t(88169),g=(0,x.Z)((0,s.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"Group"),b=t(46761),y=(0,x.Z)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),Z=t(67462),w=t(62026),j=(0,x.Z)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),P=t(92098),C=t(70247),R=t(90109),q=t(42498),S=t(11163);let k=e=>{let{delay:r,size:t,left:a}=e;return(0,s.jsx)("div",{className:"bubble",style:{width:t,height:t,left:"".concat(a,"%"),bottom:"-100px",animation:"float 3s infinite ease-in-out ".concat(r,"s"),opacity:.5*Math.random()+.1}})};function E(){let{user:e}=(0,P.a)(),r=(0,S.useRouter)(),[t,x]=(0,a.useState)(""),[E,F]=(0,a.useState)([]),[N,U]=(0,a.useState)([]),[L,M]=(0,a.useState)([]),[I,A]=(0,a.useState)(0),[_,J]=(0,a.useState)(!1),T=Array.from({length:8},(e,r)=>({id:r,size:20*Math.random()+10,left:100*Math.random(),delay:2*Math.random()}));(0,a.useEffect)(()=>{e&&(B(),O())},[e]);let B=async()=>{try{let r=await C.f.getFriends(e.uid);U(r)}catch(e){console.error("Error fetching friends:",e)}},O=async()=>{try{let r=await C.f.getPendingRequests(e.uid);M(r)}catch(e){console.error("Error fetching requests:",e)}},z=async()=>{if(!(t.length<2)){J(!0);try{console.log("Searching for:",t,"with user ID:",null==e?void 0:e.uid);let r=(0,R.hJ)(q.db,"users"),s=await (0,R.PL)(r),a=t.toLowerCase().trim().replace(/\s+/g," "),o=s.docs.map(e=>({id:e.id,...e.data()})).filter(r=>{if(r.id===(null==e?void 0:e.uid))return!1;let t=(r.username||"").toLowerCase().trim().replace(/\s+/g," "),s=(r.email||"").toLowerCase().trim(),o=(r.displayName||"").toLowerCase().trim().replace(/\s+/g," "),n=(r.firstName||"").toLowerCase().trim().replace(/\s+/g," "),i=(r.lastName||"").toLowerCase().trim().replace(/\s+/g," ");return a.split(" ").every(e=>t.includes(e)||s.includes(e)||o.includes(e)||n.includes(e)||i.includes(e))});console.log("Found users:",o),F(o)}catch(e){console.error("Error searching users:",e)}finally{J(!1)}}};(0,a.useEffect)(()=>{if(t.length>=2){let e=setTimeout(()=>{z()},300);return()=>clearTimeout(e)}F([])},[t]);let D=async r=>{try{await C.f.sendFriendRequest(e.uid,r),F(e=>e.filter(e=>e.id!==r))}catch(e){console.error("Error sending friend request:",e)}},Q=async e=>{try{await C.f.acceptFriendRequest(e),M(r=>r.filter(r=>r.id!==e)),B()}catch(e){console.error("Error accepting friend request:",e)}},W=async e=>{try{await C.f.rejectFriendRequest(e),M(r=>r.filter(r=>r.id!==e))}catch(e){console.error("Error rejecting friend request:",e)}},H=async r=>{try{await C.f.removeFriend(e.uid,r),U(e=>e.filter(e=>e.id!==r))}catch(e){console.error("Error removing friend:",e)}},V=e=>{r.push("/profile?userId=".concat(e))};return(0,s.jsxs)(o.Z,{sx:{minHeight:"100vh",pt:10,px:2,position:"relative",overflow:"hidden"},children:[T.map(e=>(0,s.jsx)(k,{...e},e.id)),(0,s.jsxs)(o.Z,{sx:{maxWidth:800,mx:"auto",position:"relative",zIndex:1},children:[(0,s.jsxs)(o.Z,{sx:{textAlign:"center",mb:4},children:[(0,s.jsx)(n.Z,{sx:{width:80,height:80,mb:2,background:"var(--glass-background)","&:hover":{background:"var(--glass-background)"}},children:(0,s.jsx)(g,{sx:{fontSize:40,color:"var(--beer-amber)"}})}),(0,s.jsx)(i.Z,{variant:"h4",className:"logo-text",gutterBottom:!0,children:"Beer Buddies"})]}),(0,s.jsxs)(d.Z,{className:"glass-card",sx:{mb:4},children:[(0,s.jsxs)(l.Z,{value:I,onChange:(e,r)=>A(r),variant:"fullWidth",sx:{borderBottom:"1px solid var(--glass-border)","& .MuiTab-root":{color:"var(--text-secondary)","&.Mui-selected":{color:"var(--beer-amber)"}},"& .MuiTabs-indicator":{backgroundColor:"var(--beer-amber)"}},children:[(0,s.jsx)(c.Z,{label:"My Friends"}),(0,s.jsx)(c.Z,{label:"Add Friends"}),(0,s.jsx)(c.Z,{label:"Requests (".concat(L.length,")")})]}),(0,s.jsxs)(o.Z,{sx:{p:3},children:[0===I&&(0,s.jsxs)(u.Z,{children:[N.map(e=>{var r,t,a,o;return(0,s.jsxs)(m.ZP,{button:!0,onClick:()=>V(e.id),sx:{borderBottom:"1px solid var(--border-color)","&:last-child":{borderBottom:"none"}},children:[(0,s.jsx)(h.Z,{src:e.photoURL,sx:{mr:2,bgcolor:"var(--beer-amber)"},children:(null===(t=e.username)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.toUpperCase())||(null===(o=e.email)||void 0===o?void 0:null===(a=o[0])||void 0===a?void 0:a.toUpperCase())}),(0,s.jsx)(p.Z,{primary:e.username||e.displayName||e.email,secondary:e.email}),(0,s.jsx)(v.Z,{children:(0,s.jsx)(n.Z,{edge:"end",onClick:r=>{r.stopPropagation(),H(e.id)},sx:{color:"var(--text-secondary)"},children:(0,s.jsx)(b.Z,{})})})]},e.id)}),0===N.length&&(0,s.jsx)(m.ZP,{children:(0,s.jsx)(p.Z,{primary:"No friends yet",secondary:"Add some friends to see their beer journey!",sx:{textAlign:"center",color:"var(--text-secondary)"}})})]}),1===I&&(0,s.jsxs)(o.Z,{sx:{p:2},children:[(0,s.jsx)(f.Z,{fullWidth:!0,variant:"outlined",placeholder:"Search users by name or email",value:t,onChange:e=>x(e.target.value),InputProps:{startAdornment:(0,s.jsx)(y,{sx:{mr:1,color:"var(--text-secondary)"}})},sx:{mb:2,"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--border-color)"},"&:hover fieldset":{borderColor:"var(--beer-amber)"},"&.Mui-focused fieldset":{borderColor:"var(--beer-amber)"}}}}),(0,s.jsxs)(u.Z,{children:[E.map(e=>{var r,t,a,o;return(0,s.jsxs)(m.ZP,{sx:{borderBottom:"1px solid var(--border-color)","&:last-child":{borderBottom:"none"}},children:[(0,s.jsx)(h.Z,{src:e.photoURL,sx:{mr:2,bgcolor:"var(--beer-amber)"},children:(null===(t=e.username)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.toUpperCase())||(null===(o=e.email)||void 0===o?void 0:null===(a=o[0])||void 0===a?void 0:a.toUpperCase())}),(0,s.jsx)(p.Z,{primary:e.username||e.displayName||e.email,secondary:e.email}),(0,s.jsx)(v.Z,{children:(0,s.jsx)(n.Z,{edge:"end",onClick:()=>D(e.id),sx:{color:"var(--beer-amber)"},children:(0,s.jsx)(Z.Z,{})})})]},e.id)}),t.length>=2&&0===E.length&&(0,s.jsx)(m.ZP,{children:(0,s.jsx)(p.Z,{primary:"No users found",secondary:"Try a different search term",sx:{textAlign:"center",color:"var(--text-secondary)"}})})]})]}),2===I&&(0,s.jsxs)(u.Z,{children:[L.map(e=>{var r,t,a,o;return(0,s.jsxs)(m.ZP,{sx:{borderBottom:"1px solid var(--border-color)","&:last-child":{borderBottom:"none"}},children:[(0,s.jsx)(h.Z,{src:e.senderPhotoURL,sx:{mr:2,bgcolor:"var(--beer-amber)"},children:(null===(t=e.senderUsername)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.toUpperCase())||(null===(o=e.senderEmail)||void 0===o?void 0:null===(a=o[0])||void 0===a?void 0:a.toUpperCase())}),(0,s.jsx)(p.Z,{primary:e.senderUsername||e.senderEmail,secondary:e.senderEmail}),(0,s.jsxs)(v.Z,{children:[(0,s.jsx)(n.Z,{edge:"end",onClick:()=>Q(e.id),sx:{color:"var(--beer-amber)",mr:1},children:(0,s.jsx)(w.Z,{})}),(0,s.jsx)(n.Z,{edge:"end",onClick:()=>W(e.id),sx:{color:"var(--text-secondary)"},children:(0,s.jsx)(j,{})})]})]},e.id)}),0===L.length&&(0,s.jsx)(m.ZP,{children:(0,s.jsx)(p.Z,{primary:"No pending requests",secondary:"Friend requests will appear here",sx:{textAlign:"center",color:"var(--text-secondary)"}})})]})]})]})]})]})}},70247:function(e,r,t){"use strict";t.d(r,{f:function(){return n}});var s=t(42498),a=t(90109);class o{async searchUsers(e,r){let t=(0,a.hJ)(s.db,"users"),o=e.toLowerCase(),n=(await (0,a.PL)(t)).docs.map(e=>({id:e.id,...e.data()})),[i,d]=await Promise.all([this.getFriends(r),this.getPendingRequests(r)]),l=new Set(i.map(e=>e.id)),c=new Set(d.map(e=>e.senderId));return n.filter(e=>{var t,s,a;return!(e.id===r||l.has(e.id)||c.has(e.id))&&((null===(t=e.username)||void 0===t?void 0:t.toLowerCase().includes(o))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(o))||(null===(a=e.displayName)||void 0===a?void 0:a.toLowerCase().includes(o))||"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(o))})}async sendFriendRequest(e,r){if(await this.areFriends(e,r))throw Error("Users are already friends");if(await this.getExistingRequest(e,r))throw Error("A friend request already exists between these users");let t="".concat(e,"_").concat(r),o=(await (0,a.QT)((0,a.JU)(s.db,"users",e))).data();await (0,a.pl)((0,a.JU)(s.db,"friendRequests",t),{senderId:e,receiverId:r,senderUsername:o.username||o.displayName||"",senderEmail:o.email||"",senderPhotoURL:o.photoURL||"",status:"pending",createdAt:(0,a.Bt)()})}async acceptFriendRequest(e){let r=(0,a.JU)(s.db,"friendRequests",e),t=await (0,a.QT)(r);if(!t.exists())throw Error("Friend request not found");let{senderId:o,receiverId:n}=t.data(),i="".concat(o,"_").concat(n);await (0,a.pl)((0,a.JU)(s.db,"friendships",i),{user1:o,user2:n,createdAt:(0,a.Bt)()}),await (0,a.oe)(r)}async rejectFriendRequest(e){await (0,a.oe)((0,a.JU)(s.db,"friendRequests",e))}async getPendingRequests(e){try{let r=(0,a.IO)((0,a.hJ)(s.db,"friendRequests"),(0,a.ar)("receiverId","==",e),(0,a.ar)("status","==","pending"));return(await (0,a.PL)(r)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting pending requests:",e),[]}}async getFriends(e){let r=(0,a.hJ)(s.db,"friendships"),t=(0,a.IO)(r,(0,a.or)((0,a.ar)("user1","==",e),(0,a.ar)("user2","==",e))),o=(await (0,a.PL)(t)).docs.map(e=>e.data()).map(r=>r.user1===e?r.user2:r.user1).map(e=>(0,a.QT)((0,a.JU)(s.db,"users",e)));return(await Promise.all(o)).filter(e=>e.exists()).map(e=>({id:e.id,...e.data(),isFriend:!0}))}async removeFriend(e,r){let t="".concat(e,"_").concat(r),o="".concat(r,"_").concat(e);try{await (0,a.oe)((0,a.JU)(s.db,"friendships",t))}catch(e){await (0,a.oe)((0,a.JU)(s.db,"friendships",o))}}async areFriends(e,r){try{let t="".concat(e,"_").concat(r),o="".concat(r,"_").concat(e),[n,i]=await Promise.all([(0,a.QT)((0,a.JU)(s.db,"friendships",t)),(0,a.QT)((0,a.JU)(s.db,"friendships",o))]);return n.exists()||i.exists()}catch(e){return console.error("Error checking friendship status:",e),!1}}async getSentRequests(e){try{let r=(0,a.IO)((0,a.hJ)(s.db,"friendRequests"),(0,a.ar)("senderId","==",e),(0,a.ar)("status","==","pending"));return(await (0,a.PL)(r)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting sent requests:",e),[]}}async getExistingRequest(e,r){let t=(0,a.hJ)(s.db,"friendRequests"),o=(0,a.IO)(t,(0,a.ar)("senderId","==",e),(0,a.ar)("receiverId","==",r),(0,a.ar)("status","==","pending")),n=(0,a.IO)(t,(0,a.ar)("senderId","==",r),(0,a.ar)("receiverId","==",e),(0,a.ar)("status","==","pending")),[i,d]=await Promise.all([(0,a.PL)(o),(0,a.PL)(n)]),l=[...i.docs,...d.docs];return l.length>0?{id:l[0].id,...l[0].data()}:null}}let n=new o}},function(e){e.O(0,[903,218,774,888,179],function(){return e(e.s=11057)}),_N_E=e.O()}]);